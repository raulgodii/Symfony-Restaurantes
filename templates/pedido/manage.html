{% extends 'base.html' %}

{% block title %}SuperMart - Productos
{% endblock %}

{% block body %}

	<!-- Breadcrumb Section Begin -->
	<section class="breadcrumb-section set-bg" data-setbg="{{ asset('img/breadcrumb.jpg') }}">
		<div class="container">
			<div class="row">
				<div class="col-lg-12 text-center">
					<div class="breadcrumb__text">
						<h2>Mis pedidos</h2>
						<div class="breadcrumb__option">
							<span>Gesti√≥n de pedidos</span>
						</div>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- Breadcrumb Section End -->

	<!-- Shoping Cart Section Begin -->
	<section class="shoping-cart spad">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="shoping__cart__table">
						<div class="row">
							<div class="col-lg-12">
								<div class="shoping__cart__btns">
									<a href="{{ path('app_categoria_new') }}" class="primary-btn cart-btn cart-btn-right">
										<i class="fa-solid fa-plus"></i>
										Crear</a>
								</div>
							</div>
							<div class="col-lg-6">
								<div class="shoping__continue">
									<div class="shoping__discount">
										<form action="#"></form>
									</div>
								</div>
							</div>
						</div>
						<table>
							<thead>
								<tr>
									<th>Id</th>
									<th>Fecha</th>
									<th>Estado</th>
									<th>Total</th>
								</tr>
							</thead>
							<tbody>
								{% for pedido in pedidosConProductos %}

									<tr>
										<td class="shoping__cart__price">
											<h5>{{ pedido.pedido.getId() }}</h5>
										</td>

										<td class="shoping__cart__price">
											<h5>{{ pedido.pedido.getFecha()|date('d/m/Y') }}</h5>
										</td>

										<td class="shoping__cart__price">
											<h5>{{ pedido.pedido.isEnviado() ? 'Enviado' : 'No enviado' }}</h5>
										</td>
										{% set total = 0 %}
										{% for producto in pedido.productos %}
											{% set total = total + (producto.precio * producto.unidades) %}
										{% endfor %}

										<td class="shoping__cart__price">
											<h5>{{ total }}</h5>
										</td>
									</tr>
								{% else %}
									<tr>
										<td colspan="6">Sin pedidos</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- Shoping Cart Section End -->

	<h2>Detalles del Pedido</h2>
	{% for pedido in pedidosConProductos %}
		<p>ID del Pedido:
			{{ pedido.pedido.getId() }}</p>
		<p>Fecha del Pedido:
			{{ pedido.pedido.getFecha()|date('d/m/Y') }}</p>
		<p>Estado del Pedido:
			{{ pedido.pedido.isEnviado() ? 'Enviado' : 'No enviado' }}</p>
		<a href="{{ path('app_pedido_eliminar', {'id': pedido.pedido.getId()}) }}">Borrar</a>
		<a href="{{ path('app_pedido_enviar', {'id': pedido.pedido.getId()}) }}">Enviar</a>

		<h4>Productos en el Pedido</h4>
		<ul>
			{% set total = 0 %}
			{% for producto in pedido.productos %}
				<li>Nombre:
					{{ producto.nombre }}
					- Precio:
					{{ producto.precio }}
					- Unidades:
					{{ producto.unidades }}</li>
				{% set total = total + (producto.precio * producto.unidades) %}
			{% endfor %}
		</ul>
		<p>Total del pedido:
			{{ total }}</p>
	{% endfor %}
	<!-- Shoping Cart Section End -->
{% endblock %}
