{% extends 'base.html.twig' %}

{% block title %}Mis Pedidos{% endblock %}

{% block body %}
<h1>Mis Pedidos</h1>

{% for pedido in pedidosConProductos %}
    <h2>Detalles del Pedido</h2>
    <p>ID del Pedido: {{ pedido.pedido.getId() }}</p>
    <p>Fecha del Pedido: {{ pedido.pedido.getFecha()|date('d/m/Y') }}</p>
    <p>Estado del Pedido: {{ pedido.pedido.isEnviado() ? 'Enviado' : 'No enviado' }}</p>
    <a href="{{ path('app_pedido_eliminar', {'id': pedido.pedido.getId()}) }}">Borrar</a>
    <a href="{{ path('app_pedido_enviar', {'id': pedido.pedido.getId()}) }}">Enviar</a>

    <h4>Productos en el Pedido</h4>
    <ul>
        {% set total = 0 %}
        {% for producto in pedido.productos %}
            <li>Nombre: {{ producto.nombre }} - Precio: {{ producto.precio }} - Unidades: {{ producto.unidades }}</li>
            {% set total = total + (producto.precio * producto.unidades) %}
        {% endfor %}
    </ul>
    <p>Total del pedido: {{ total }}</p>
{% endfor %}

{% endblock %}